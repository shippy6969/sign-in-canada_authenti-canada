<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
  
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <!-- Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
		  wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html -->
  <title>Session Management</title>
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <!-- Meta data -->
  <meta name="description" content="Sign In Canada.">
  <!-- Meta data-->
  <!--[if gte IE 9 | !IE ]><!-->
  <link href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/assets/favicon.ico" rel="icon" type="image/x-icon">
  <link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/css/theme.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
  <link rel="stylesheet" href="/sign-in-canada_authenti-canada/assets/style.css">
  <!--<![endif]-->
  <!--[if lt IE 9]>
  <link href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/assets/favicon.ico" rel="shortcut icon" />
  <link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/css/ie8-theme.min.css" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/js/ie8-wet-boew.min.js"></script>
	<![endif]-->
  <!--[if lte IE 9]> <![endif]-->
  <noscript><link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/css/noscript.min.css"></noscript>
</head>
<body vocab="http://schema.org/" typeof="WebPage" class="page-discover-session">
<ul id="wb-tphp">
  <li class="wb-slc"><a class="wb-sl" href="#wb-cont">Skip to main content</a></li>
  <li class="wb-slc visible-sm visible-md visible-lg"><a class="wb-sl" href="#wb-info">Skip to "About this site"</a></li>
</ul>

<header>
  <div id="wb-bnr" class="container">
    <section id="wb-lng" class="visible-md visible-lg text-right">
      <h2 class="wb-inv">Language selection</h2>
      <div class="row">
        <div class="col-md-12">
          <ul class="list-inline margin-bottom-none">
            <li><a lang="fr" hreflang="fr" href="/sign-in-canada_authenti-canada/fr/decouvrir/gestion-des-sessions.html">Français</a></li>
          </ul>
        </div>
      </div>
    </section>

    <div class="row">
      <div class="brand col-xs-8 col-sm-9 col-md-6">
        <a href="https://www.canada.ca/en.html">
          <img src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/assets/sig-blk-en.svg" alt="Government of Canada / Gouvernement du Canada">
          <span class="wb-inv"> Government of Canada / <span lang="fr">Gouvernement du Canada</span></span>
        </a>
      </div>

      <section class="wb-mb-links col-xs-4 col-sm-3 visible-sm visible-xs" id="wb-glb-mn">
        <h2>Menus</h2>
        <ul class="list-inline text-right chvrn">
          <li><a href="#mb-pnl" title="Menus" aria-controls="mb-pnl" class="overlay-lnk" role="button"><span class="glyphicon glyphicon-th-list"><span class="wb-inv">Menus</span></span></a></li>
        </ul>
        <div id="mb-pnl"></div>
      </section>
    </div>
  </div>

  <nav class="gcweb-menu" typeof="SiteNavigationElement">
    <div class="container nvbar">
      <h2 class="wb-inv">Menu</h2>
      <button type="button" aria-haspopup="true" aria-expanded="false"><span class="wb-inv">Main </span>Menu <span class="expicon glyphicon glyphicon-chevron-down"></span></button>
      <ul role="menu" aria-orientation="vertical">
        <li role="presentation"><a role="menuitem" href="/sign-in-canada_authenti-canada/en/discover/index.html">Discover</a></li>
        <li role="presentation"><a role="menuitem" href="/sign-in-canada_authenti-canada/en/evaluate/index.html">Evaluate</a></li>
        <li role="presentation"><a role="menuitem" href="/sign-in-canada_authenti-canada/en/join/index.html">Join</a></li>
        <li role="presentation"><a role="menuitem" href="/sign-in-canada_authenti-canada/en/contribute/index.html">Contribute</a></li>
      </ul>
    </div>
  </nav>
  <nav id="wb-bc" property="breadcrumb">
    <h2>You are here:</h2>
    <div class="container">
      <ol class="breadcrumb">
        <li><a href="/sign-in-canada_authenti-canada/en/index.html">Sign In Canada</a></li>
<li><a href="/sign-in-canada_authenti-canada/en/discover/index.html">Discover</a></li>
          <li><a href="/sign-in-canada_authenti-canada/en/discover/session-management.html">Session Management</a></li>
</ol>
    </div>
  </nav>
</header>

<main property="mainContentOfPage" class="container">

<h1 id="session-management">Session Management</h1>

<p>The Sign in Canada Platform functions as a session management authority that
centrally coordinates users’ sessions across multiple Relying Party (RP)
applications. There are two key features of the platform that support this:
single sign-on, and single logout.</p>

<h2 id="single-sign-on">Single Sign-On</h2>

<p>Once a user has successfully used a given credential or trusted digital identity
service to authenticate to one RP, Sign In Canada can allow them to silently
authenticate to other RPs subject to a single sign-on timeout period. The
platform accomplishes this by creating its own session with the user when they
first sign in, and then simply not prompting them to re-authenticate when they
sign in to other RPs within a specified timeout window.</p>

<p>The timeout window for single sign-on starts whenever a user enters their
correct password at a credential service provider (CSP), and ends after a
specified period of time has elapsed. By default this is 20 minutes, but Sign
In Canada relying parties can change this if desired. It is important to note
however that the single sign-on window of the legacy GCKey and Credential Broker
services, which is also 20 minutes, cannot be changed, it can only be disabled
(called forced authentication). In any situation where the “hard-coded” legacy
timeout might come into conflict with a relying party’s preferred timeout, the
Sign In Canada platform will automatically synchronize the two, and resolve the
conflict.</p>

<p><em>Note that in order for single sign-on to work, a user must use the same
credential or trusted digital identity to access all digital government
services. At present, this not possible since not all Government of Canada
services accept the same credentials. For example, accessing online tax services
provided by CRA is currently not possible using a CKey credential, therefore
users who chose to use a GCKey credential cannot single sign-on to CRA’s <a href="https://www.canada.ca/en/revenue-agency/services/e-services/e-services-individuals/account-individuals.html">My
Account for
Individuals</a>.</em></p>

<h2 id="single-logout">Single Logout</h2>

<p>When a user has visited multiple web sites (Relying Party applications) during
the same session, the Sign In Canada Platform has the ability to centrally
coordinate single logout. With single logout, the user only has to click one
logout button on the site they are currently visiting, and Sign In Canada will
then log them out of all the other sites they have visited during their session.</p>

<p>The propagation of logout across all of these sites can use the <a href="https://openid.net/specs/openid-connect-frontchannel-1_0.html">OpenID Connect
Front-Channel
Logout</a>
mechanism, the <a href="https://openid.net/specs/openid-connect-backchannel-1_0.html">OpenID Connect Back-Channel
Logout</a> mechanism,
or the <a href="https://www.oasis-open.org/committees/download.php/56782/sstc-saml-profiles-errata-2.0-wd-07.html">SAML Single Logout
Profile</a>
using front-channel (HTTP-Redirect) and/or back-channel (SOAP) <a href="https://www.oasis-open.org/committees/download.php/56779/sstc-saml-bindings-errata-2.0-wd-06.pdf">bindings</a>.
The Sign In Canada Platform supports all of these.</p>

<p>Both the OpenID Connect (OIDC) and SAML protocols follow the same basic sequence
of events:</p>

<ol>
  <li>As a user visits multiple web sites (applications) within the same session,
the Sign In Canada Platform keeps track of which sites they have visited.</li>
  <li>When the user clicks a logout button on one of the the sites they are
visiting, that site’s web application sends a logout request to the
Sign In Canada Platform.</li>
  <li>Sign In Canada then sends a logout request to all of the other sites
the user has visited, so they can log the user out.</li>
</ol>

<h2 id="transition-and-coexistence">Transition and Coexistence</h2>

<p>There will be an extended transition period as RP applications connect to Sign
In Canada and disconnect from the legacy Government of Canada Credential
Federation (GCCF) GCKey and Credential Broker services one at a time. During
this transition period, the Sign In Canada Platform will serve as the session
management authority for applications connected to it, while the GCKey and
Credential Broker services serve as the session management authority for
applications connected to them.</p>

<p>This creates a requirement for Sign In Canada to coordinate single logout with
GCKey and CBS, as well as with its own RPs. The platform accomplishes this by
supporting the SAML Single Logout profile as part of its integration, as a SAML
proxying identity provider, with GCKey and CBS. The Sign In Canada platform is
able to coordinate single logout with the legacy GCCF in both directions. That
is, regardless of whether the user logs out of Sign In Canada first or whether they
log out of the GCCF first.</p>

<h3 id="scenario-1-a-user-logs-out-of-sign-in-canada-first">Scenario 1: A user logs out of Sign In Canada first</h3>

<p>The following example scenario illustrates how single logout is achieved in the
case where the user clicks a logout button on a relying party site that is connected to
Sign In Canada.</p>

<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="1141px" preserveaspectratio="none" style="width:1104px;height:1141px;background:#FFFFFF;" version="1.1" viewbox="0 0 1104 1141" width="1104px" zoomandpan="magnify"><defs><lineargradient id="gkelu6itpaf700" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#00FFFF"></stop><stop offset="100%" stop-color="#5F9EA0"></stop></lineargradient></defs><g><rect fill="url(#gkelu6itpaf700)" height="26.2969" id="_title" rx="7.5" ry="7.5" style="stroke:#FF0000;stroke-width:2.0;" width="400" x="353.5" y="10"></rect><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthadjust="spacing" textlength="390" x="358.5" y="27.9951">Logout initiated by a Sign In Canada Relying Party</text><rect fill="#DDDDDD" height="1092.25" style="stroke:#181818;stroke-width:0.5;" width="320" x="341.5" y="43.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="111" x="446" y="55.3638">Sign In Canada</text><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="614" x="335.5" y="265.125"></rect><rect fill="none" height="400.7266" style="stroke:#000000;stroke-width:1.5;" width="1088" x="10" y="425.7891"></rect><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="430.5" x="657.5" y="637.7188"></rect><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="471.5" x="10" y="840.5156"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="51" x2="51" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="284.5" x2="284.5" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="408.5" x2="408.5" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="569.5" x2="569.5" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="727.5" x2="727.5" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="857.5" x2="857.5" y1="118.5938" y2="1056.25"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="995.5" x2="995.5" y1="118.5938" y2="1056.25"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="57" x="20" y="115.292">Browser</text><ellipse cx="51.5" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M51.5,58.7969 L51.5,85.7969 M38.5,66.7969 L64.5,66.7969 M51.5,85.7969 L38.5,100.7969 M51.5,85.7969 L64.5,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="57" x="20" y="1068.2451">Browser</text><ellipse cx="51.5" cy="1080.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M51.5,1088.0469 L51.5,1115.0469 M38.5,1096.0469 L64.5,1096.0469 M51.5,1115.0469 L38.5,1130.0469 M51.5,1115.0469 L64.5,1130.0469 " fill="none" style="stroke:#181818;stroke-width:0.5;"></path><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="233.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="88" x="240.5" y="107.292">Relying Party</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="233.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="88" x="240.5" y="1075.2451">Relying Party</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="345.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="112" x="352.5" y="107.292">OpenID Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="345.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="112" x="352.5" y="1075.2451">OpenID Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="481.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="162" x="488.5" y="107.292">Acceptance Framework</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="481.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="162" x="488.5" y="1075.2451">Acceptance Framework</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="667.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="674.5" y="107.292">SAML IDP (CSP)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="667.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="674.5" y="1075.2451">SAML IDP (CSP)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="797.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="804.5" y="107.292">Other SIC RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="797.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="804.5" y="1075.2451">Other SIC RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="927.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123" x="934.5" y="107.292">Other GCCF RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="927.5" y="1055.25"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123" x="934.5" y="1075.2451">Other GCCF RP(s)</text><polygon fill="#181818" points="272.5,145.7266,282.5,149.7266,272.5,153.7266,276.5,149.7266" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="278.5" y1="149.7266" y2="149.7266"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="40" x="58.5" y="144.6606">logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="284.5" x2="326.5" y1="178.8594" y2="178.8594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="326.5" x2="326.5" y1="178.8594" y2="191.8594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="285.5" x2="326.5" y1="191.8594" y2="191.8594"></line><polygon fill="#181818" points="295.5,187.8594,285.5,191.8594,295.5,195.8594,291.5,191.8594" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="77" x="291.5" y="173.7935">Local logout</text><polygon fill="#181818" points="62.5,199.8594,52.5,203.8594,62.5,207.8594,58.5,203.8594" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="283.5" y1="203.8594" y2="203.8594"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="209" x="68.5" y="216.9263">redirect to end_session endpoint</text><polygon fill="#181818" points="396.5,246.125,406.5,250.125,396.5,254.125,400.5,250.125" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="402.5" y1="250.125" y2="250.125"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="245" x="58.5" y="245.0591">HTTP request to end_session endpoint</text><path d="M335.5,265.125 L405.5,265.125 L405.5,272.2578 L395.5,282.2578 L335.5,282.2578 L335.5,265.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="614" x="335.5" y="265.125"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="25" x="350.5" y="278.1919">Par</text><line style="stroke:#181818;stroke-width:1.0;" x1="855.5" x2="845.5" y1="303.3906" y2="299.3906"></line><line style="stroke:#181818;stroke-width:1.0;" x1="855.5" x2="845.5" y1="303.3906" y2="307.3906"></line><line style="stroke:#181818;stroke-width:1.0;" x1="408.5" x2="856.5" y1="303.3906" y2="303.3906"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="235" x="415.5" y="298.3247">OIDC back-channel logout request(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="857.5" x2="899.5" y1="332.5234" y2="332.5234"></line><line style="stroke:#181818;stroke-width:1.0;" x1="899.5" x2="899.5" y1="332.5234" y2="345.5234"></line><line style="stroke:#181818;stroke-width:1.0;" x1="858.5" x2="899.5" y1="345.5234" y2="345.5234"></line><polygon fill="#181818" points="868.5,341.5234,858.5,345.5234,868.5,349.5234,864.5,345.5234" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="864.5" y="327.4575">local logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="409.5" x2="419.5" y1="357.5234" y2="353.5234"></line><line style="stroke:#181818;stroke-width:1.0;" x1="409.5" x2="419.5" y1="357.5234" y2="361.5234"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="408.5" x2="856.5" y1="357.5234" y2="357.5234"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="110" x="740.5" y="370.5903">logout responses</text><polygon fill="#181818" points="62.5,389.6563,52.5,393.6563,62.5,397.6563,58.5,393.6563" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="407.5" y1="393.6563" y2="393.6563"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="242" x="159.5" y="406.7231">Logout propagation page with iframes</text><path d="M10,425.7891 L80,425.7891 L80,432.9219 L70,442.9219 L10,442.9219 L10,425.7891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="400.7266" style="stroke:#000000;stroke-width:1.5;" width="1088" x="10" y="425.7891"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="25" x="25" y="438.856">Par</text><line style="stroke:#181818;stroke-width:1.0;" x1="855.5" x2="845.5" y1="464.0547" y2="460.0547"></line><line style="stroke:#181818;stroke-width:1.0;" x1="855.5" x2="845.5" y1="464.0547" y2="468.0547"></line><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="856.5" y1="464.0547" y2="464.0547"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="235" x="58.5" y="458.9888">OIDC front-channel logout request(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="857.5" x2="899.5" y1="493.1875" y2="493.1875"></line><line style="stroke:#181818;stroke-width:1.0;" x1="899.5" x2="899.5" y1="493.1875" y2="506.1875"></line><line style="stroke:#181818;stroke-width:1.0;" x1="858.5" x2="899.5" y1="506.1875" y2="506.1875"></line><polygon fill="#181818" points="868.5,502.1875,858.5,506.1875,868.5,510.1875,864.5,506.1875" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="864.5" y="488.1216">local logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="518.1875" y2="514.1875"></line><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="518.1875" y2="522.1875"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51.5" x2="856.5" y1="518.1875" y2="518.1875"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="112" x="738.5" y="531.2544">HTTP response(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="557.5" y1="564.4531" y2="560.4531"></line><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="557.5" y1="564.4531" y2="568.4531"></line><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="568.5" y1="564.4531" y2="564.4531"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="97" x="58.5" y="559.3872">Logout request</text><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="576.4531" y2="572.4531"></line><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="576.4531" y2="580.4531"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51.5" x2="568.5" y1="576.4531" y2="576.4531"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="422.5" y="589.52">SAML Logout Request</text><line style="stroke:#181818;stroke-width:1.0;" x1="725.5" x2="715.5" y1="622.7188" y2="618.7188"></line><line style="stroke:#181818;stroke-width:1.0;" x1="725.5" x2="715.5" y1="622.7188" y2="626.7188"></line><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="726.5" y1="622.7188" y2="622.7188"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="58.5" y="617.6528">SAML Logout Request</text><path d="M657.5,637.7188 L734.5,637.7188 L734.5,644.8516 L724.5,654.8516 L657.5,654.8516 L657.5,637.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="430.5" x="657.5" y="637.7188"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="32" x="672.5" y="650.7856">loop</text><polygon fill="#181818" points="984,671.9844,994,675.9844,984,679.9844,988,675.9844" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="727.5" x2="990" y1="675.9844" y2="675.9844"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="734.5" y="670.9185">SAML Logout Request</text><line style="stroke:#181818;stroke-width:1.0;" x1="996" x2="1038" y1="705.1172" y2="705.1172"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1038" x2="1038" y1="705.1172" y2="718.1172"></line><line style="stroke:#181818;stroke-width:1.0;" x1="997" x2="1038" y1="718.1172" y2="718.1172"></line><polygon fill="#181818" points="1007,714.1172,997,718.1172,1007,722.1172,1003,718.1172" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="1003" y="700.0513">local logout</text><polygon fill="#181818" points="738.5,726.1172,728.5,730.1172,738.5,734.1172,734.5,730.1172" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="995" y1="730.1172" y2="730.1172"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="839" y="743.1841">SAML Logout Response</text><path d="M732,767.25 L732,792.25 L896,792.25 L896,777.25 L886,767.25 L732,767.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M886,767.25 L886,777.25 L896,777.25 L886,767.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="143" x="738" y="784.3169">GCCF logout complete</text><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="801.3828" y2="797.3828"></line><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="801.3828" y2="805.3828"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51.5" x2="726.5" y1="801.3828" y2="801.3828"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="570.5" y="814.4497">SAML Logout Response</text><path d="M10,840.5156 L74,840.5156 L74,847.6484 L64,857.6484 L10,857.6484 L10,840.5156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="471.5" x="10" y="840.5156"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="19" x="25" y="853.5825">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="121" x="89" y="852.7261">[an error occurred]</text><polygon fill="#181818" points="396.5,874.7813,406.5,878.7813,396.5,882.7813,400.5,878.7813" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="402.5" y1="878.7813" y2="878.7813"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="164" x="58.5" y="873.7153">Load logout warning page</text><polygon fill="#181818" points="62.5,886.7813,52.5,890.7813,62.5,894.7813,58.5,890.7813" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="283.5" y1="890.7813" y2="890.7813"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="133" x="144.5" y="903.8481">Logout warning page</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="481.5" y1="916.9141" y2="916.9141"></line><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="68" x="15" y="927.1245">[no errors]</text><polygon fill="#181818" points="272.5,947.8516,282.5,951.8516,272.5,955.8516,276.5,951.8516" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="278.5" y1="951.8516" y2="951.8516"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="111" x="58.5" y="946.7856">Load logout page</text><polygon fill="#181818" points="62.5,959.8516,52.5,963.8516,62.5,967.8516,58.5,963.8516" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="283.5" y1="963.8516" y2="963.8516"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="144" x="133.5" y="976.9185">Logout complete page</text><path d="M56,1000.9844 L56,1040.9844 L187,1040.9844 L187,1010.9844 L177,1000.9844 L56,1000.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M177,1000.9844 L177,1010.9844 L187,1010.9844 L177,1000.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="96" x="62" y="1018.0513">Sign In Canada</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="110" x="62" y="1033.1841">Logout Complete</text></g></svg>

<p>The scenario begins when a user clicks a logout button on the relying party site
they have been using. When this happens:</p>

<ol>
  <li>The relying party application logs the user out locally first, then it
redirects the browser to either the Acceptance Platforms’s OpenID Connect end_session endpoint.</li>
  <li>If any relying parties participating in the session support OpenID Connect
back-channel logout, the Acceptance Platform first sends a logout token to
all of them, via an HTTP POST to their registered back-channel logout URI(s)
to trigger the logout actions by those RPs. If there are multiple relying
parties then these requests are all sent simultaneously, in parallel.</li>
  <li>Once back-channel logout has been completed, The Acceptance Platform then
returns an <a href="https://html.spec.whatwg.org/multipage/">HTML</a> logout propagation
page to the browser. This page contains a number of
<a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a>
elements. The <code class="language-plaintext highlighter-rouge">src</code> (source) attribute of all but one of the <em>iframe</em>
elements points to the <a href="https://openid.net/specs/openid-connect-frontchannel-1_0.html#RPLogout">front-channel logout
URI</a>
of one of the Sign In Canada relying party sites where the user has logged in
during their current session. In the diagram, these other sites are
identified as “Other OIDC RPs”. The <code class="language-plaintext highlighter-rouge">src</code> attribute of the final <em>iframe</em>
points to a URI endpoint of the Acceptance Platform’s Acceptance Framework.</li>
  <li>Upon receiving the propagation page, the browser begins to load all of the of
the <em>iframe_s in parallel, by asynchronously sending an HTTP GET request to
the <code class="language-plaintext highlighter-rouge">src</code> URI of each _iframe</em>.</li>
  <li>As the other relying parties receive these requests, they log the user out
locally, and then return an HTTP response to the browser.</li>
  <li>When the Acceptance Platform’s Acceptance Framework receives its request, it
creates a SAML <code class="language-plaintext highlighter-rouge">LogoutRequest</code> message and then redirects the browser with
that message (within the <em>iframe</em>) to the legacy CSP (GCKey or CBS) that the
user chose to log in with.</li>
  <li>The legacy CSP then logs the user out of their credential. If the user has visited
any sites that are still connected directly to the CSP (instead of to Sign in
Canada) it will also propagate the logout to all of those sites, one at a time.</li>
  <li>The CSP then redirects the browser (within the <em>iframe</em>) back to the
Acceptance Platform’s Acceptance Framework with a SAML
<code class="language-plaintext highlighter-rouge">LogoutResponse</code> message. The Acceptance Framework processes this
message and then sends an HTTP response back to the browser.</li>
  <li>The logout propagation page has a global <code class="language-plaintext highlighter-rouge">onerror</code> event handler that will be
triggered if any kind of error occurs while all of the _iframe_s are
propagating the logout to various sites asynchronously.</li>
  <li>If any of the <code class="language-plaintext highlighter-rouge">iframes</code> fail or time-out, of if the SAML logout response
   from the legacy CSP indicates an error, then the <code class="language-plaintext highlighter-rouge">onerror</code>event handler will
   redirect the browser to an <a href="https://te-auth.id.tbs-sct.gc.ca/oxauth/partial.htm" target="_blank">error
   page</a>,
   warning the user that they may not be completely signed out and recommending
   that they close their browser.</li>
  <li>If all of the <code class="language-plaintext highlighter-rouge">iframes</code> successfully propagate logout to their target site,
then the browser is redirected to the logout landing page of the site where
the user initially clicked “Logout” (the relying party’s
<code class="language-plaintext highlighter-rouge">post_logout_redirect_uri</code>).</li>
</ol>

<h3 id="scenario-2-a-user-logs-out-of-the-gccf-first">Scenario 2: A user logs out of the GCCF first</h3>

<p>The next example scenario illustrates how single logout is achieved in the case
where the user clicks a logout button on a relying party site that is still
connected one of the legacy GCCF credential services (GCKey or CBS).</p>

<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="1287px" preserveaspectratio="none" style="width:1218px;height:1287px;background:#FFFFFF;" version="1.1" viewbox="0 0 1218 1287" width="1218px" zoomandpan="magnify"><defs><lineargradient id="g1qmeurx807wmm0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#00FFFF"></stop><stop offset="100%" stop-color="#5F9EA0"></stop></lineargradient></defs><g><rect fill="url(#g1qmeurx807wmm0)" height="26.2969" id="_title" rx="7.5" ry="7.5" style="stroke:#FF0000;stroke-width:2.0;" width="327" x="447.25" y="10"></rect><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthadjust="spacing" textlength="317" x="452.25" y="27.9951">Logout initiated by a GCCF Relying Party</text><rect fill="#DDDDDD" height="1237.9141" style="stroke:#181818;stroke-width:0.5;" width="320" x="723.5" y="43.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="111" x="828" y="55.3638">Sign In Canada</text><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="336" x="405" y="265.125"></rect><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="309" x="903.5" y="548.3203"></rect><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="1202.5" x="10" y="708.9844"></rect><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="535" x="10" y="978.1797"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="51" x2="51" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="333" x2="333" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="475" x2="475" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="648.5" x2="648.5" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="815.5" x2="815.5" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="976.5" x2="976.5" y1="118.5938" y2="1201.9141"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1120.5" x2="1120.5" y1="118.5938" y2="1201.9141"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="57" x="20" y="115.292">Browser</text><ellipse cx="51.5" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M51.5,58.7969 L51.5,85.7969 M38.5,66.7969 L64.5,66.7969 M51.5,85.7969 L38.5,100.7969 M51.5,85.7969 L64.5,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="57" x="20" y="1213.9092">Browser</text><ellipse cx="51.5" cy="1225.7109" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M51.5,1233.7109 L51.5,1260.7109 M38.5,1241.7109 L64.5,1241.7109 M51.5,1260.7109 L38.5,1275.7109 M51.5,1260.7109 L64.5,1275.7109 " fill="none" style="stroke:#181818;stroke-width:0.5;"></path><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143" x="262" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="129" x="269" y="107.292">SAML Relying Party</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143" x="262" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="129" x="269" y="1220.9092">SAML Relying Party</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="415" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="422" y="107.292">SAML IDP (CSP)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="415" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="422" y="1220.9092">SAML IDP (CSP)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="580.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123" x="587.5" y="107.292">Other GCCF RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="580.5" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123" x="587.5" y="1220.9092">Other GCCF RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="727.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="162" x="734.5" y="107.292">Acceptance Framework</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="176" x="727.5" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="162" x="734.5" y="1220.9092">Acceptance Framework</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="913.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="112" x="920.5" y="107.292">OpenID Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="913.5" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="112" x="920.5" y="1220.9092">OpenID Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="1060.5" y="87.2969"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="1067.5" y="107.292">Other SIC RP(s)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="1060.5" y="1200.9141"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="106" x="1067.5" y="1220.9092">Other SIC RP(s)</text><polygon fill="#181818" points="321.5,145.7266,331.5,149.7266,321.5,153.7266,325.5,149.7266" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="327.5" y1="149.7266" y2="149.7266"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="40" x="58.5" y="144.6606">logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="375.5" y1="178.8594" y2="178.8594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="375.5" x2="375.5" y1="178.8594" y2="191.8594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="334.5" x2="375.5" y1="191.8594" y2="191.8594"></line><polygon fill="#181818" points="344.5,187.8594,334.5,191.8594,344.5,195.8594,340.5,191.8594" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="77" x="340.5" y="173.7935">Local logout</text><polygon fill="#181818" points="62.5,199.8594,52.5,203.8594,62.5,207.8594,58.5,203.8594" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="332.5" y1="203.8594" y2="203.8594"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="258" x="68.5" y="216.9263">HTTP redirect with SAML Logout Request</text><polygon fill="#181818" points="463,246.125,473,250.125,463,254.125,467,250.125" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="469" y1="250.125" y2="250.125"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="58.5" y="245.0591">SAML Logout Request</text><path d="M405,265.125 L482,265.125 L482,272.2578 L472,282.2578 L405,282.2578 L405,265.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="336" x="405" y="265.125"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="32" x="420" y="278.1919">loop</text><polygon fill="#181818" points="637,299.3906,647,303.3906,637,307.3906,641,303.3906" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="475" x2="643" y1="303.3906" y2="303.3906"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="482" y="298.3247">SAML Logout Request</text><line style="stroke:#181818;stroke-width:1.0;" x1="649" x2="691" y1="332.5234" y2="332.5234"></line><line style="stroke:#181818;stroke-width:1.0;" x1="691" x2="691" y1="332.5234" y2="345.5234"></line><line style="stroke:#181818;stroke-width:1.0;" x1="650" x2="691" y1="345.5234" y2="345.5234"></line><polygon fill="#181818" points="660,341.5234,650,345.5234,660,349.5234,656,345.5234" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="656" y="327.4575">local logout</text><polygon fill="#181818" points="486,353.5234,476,357.5234,486,361.5234,482,357.5234" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="480" x2="648" y1="357.5234" y2="357.5234"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="492" y="370.5903">SAML Logout Response</text><path d="M480,394.6563 L480,419.6563 L644,419.6563 L644,404.6563 L634,394.6563 L480,394.6563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M634,394.6563 L634,404.6563 L644,404.6563 L634,394.6563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="143" x="486" y="411.7231">GCCF logout complete</text><polygon fill="#181818" points="62.5,424.7891,52.5,428.7891,62.5,432.7891,58.5,428.7891" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="474" y1="428.7891" y2="428.7891"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="202" x="266" y="441.856">HTTP redirect to Sign In Canada</text><polygon fill="#181818" points="803.5,471.0547,813.5,475.0547,803.5,479.0547,807.5,475.0547" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="809.5" y1="475.0547" y2="475.0547"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="140" x="58.5" y="469.9888">SAML Logout Request</text><polygon fill="#181818" points="62.5,483.0547,52.5,487.0547,62.5,491.0547,58.5,487.0547" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="814.5" y1="487.0547" y2="487.0547"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="248" x="560.5" y="500.1216">HTTP Redirect to end_session endpoint</text><polygon fill="#181818" points="964.5,529.3203,974.5,533.3203,964.5,537.3203,968.5,533.3203" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="970.5" y1="533.3203" y2="533.3203"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="293" x="58.5" y="528.2544">OIDC Logout request to end_session endpoint</text><path d="M903.5,548.3203 L973.5,548.3203 L973.5,555.4531 L963.5,565.4531 L903.5,565.4531 L903.5,548.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="309" x="903.5" y="548.3203"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="25" x="918.5" y="561.3872">Par</text><line style="stroke:#181818;stroke-width:1.0;" x1="1118.5" x2="1108.5" y1="586.5859" y2="582.5859"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1118.5" x2="1108.5" y1="586.5859" y2="590.5859"></line><line style="stroke:#181818;stroke-width:1.0;" x1="976.5" x2="1119.5" y1="586.5859" y2="586.5859"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="110" x="983.5" y="581.52">logout request(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1120.5" x2="1162.5" y1="615.7188" y2="615.7188"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1162.5" x2="1162.5" y1="615.7188" y2="628.7188"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1121.5" x2="1162.5" y1="628.7188" y2="628.7188"></line><polygon fill="#181818" points="1131.5,624.7188,1121.5,628.7188,1131.5,632.7188,1127.5,628.7188" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="1127.5" y="610.6528">local logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="977.5" x2="987.5" y1="640.7188" y2="636.7188"></line><line style="stroke:#181818;stroke-width:1.0;" x1="977.5" x2="987.5" y1="640.7188" y2="644.7188"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="976.5" x2="1119.5" y1="640.7188" y2="640.7188"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="120" x="993.5" y="653.7856">logout response(s)</text><polygon fill="#181818" points="62.5,672.8516,52.5,676.8516,62.5,680.8516,58.5,676.8516" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="975.5" y1="676.8516" y2="676.8516"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="242" x="727.5" y="689.9185">Logout propagation page with iframes</text><path d="M10,708.9844 L80,708.9844 L80,716.1172 L70,726.1172 L10,726.1172 L10,708.9844 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="1202.5" x="10" y="708.9844"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="25" x="25" y="722.0513">Par</text><line style="stroke:#181818;stroke-width:1.0;" x1="1118.5" x2="1108.5" y1="747.25" y2="743.25"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1118.5" x2="1108.5" y1="747.25" y2="751.25"></line><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="1119.5" y1="747.25" y2="747.25"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="235" x="58.5" y="742.1841">OIDC front-channel logout request(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1120.5" x2="1162.5" y1="776.3828" y2="776.3828"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1162.5" x2="1162.5" y1="776.3828" y2="789.3828"></line><line style="stroke:#181818;stroke-width:1.0;" x1="1121.5" x2="1162.5" y1="789.3828" y2="789.3828"></line><polygon fill="#181818" points="1131.5,785.3828,1121.5,789.3828,1131.5,793.3828,1127.5,789.3828" style="stroke:#181818;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="73" x="1127.5" y="771.3169">local logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="801.3828" y2="797.3828"></line><line style="stroke:#181818;stroke-width:1.0;" x1="52.5" x2="62.5" y1="801.3828" y2="805.3828"></line><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51.5" x2="1119.5" y1="801.3828" y2="801.3828"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="112" x="1001.5" y="814.4497">HTTP response(s)</text><polygon fill="#181818" points="803.5,850.6484,813.5,854.6484,803.5,858.6484,807.5,854.6484" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="809.5" y1="854.6484" y2="854.6484"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="184" x="58.5" y="849.5825">Logout result (Success / Fail)</text><polygon fill="#181818" points="62.5,862.6484,52.5,866.6484,62.5,870.6484,58.5,866.6484" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="814.5" y1="866.6484" y2="866.6484"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="658.5" y="879.7153">SAML Logout Response</text><path d="M56,896.7813 L56,936.7813 L187,936.7813 L187,906.7813 L177,896.7813 L56,896.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M177,896.7813 L177,906.7813 L187,906.7813 L177,896.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="96" x="62" y="913.8481">Sign In Canada</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="110" x="62" y="928.981">Logout Complete</text><polygon fill="#181818" points="463,959.1797,473,963.1797,463,967.1797,467,963.1797" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="469" y1="963.1797" y2="963.1797"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="58.5" y="958.1138">SAML Logout Response</text><path d="M10,978.1797 L74,978.1797 L74,985.3125 L64,995.3125 L10,995.3125 L10,978.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="535" x="10" y="978.1797"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="19" x="25" y="991.2466">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="97" x="89" y="990.3901">[logout failure]</text><polygon fill="#181818" points="62.5,995.3125,52.5,999.3125,62.5,1003.3125,58.5,999.3125" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="474" y1="999.3125" y2="999.3125"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="316" x="152" y="1012.3794">SAML Logout Response with "Partial Logout" code</text><polygon fill="#181818" points="321.5,1041.5781,331.5,1045.5781,321.5,1049.5781,325.5,1045.5781" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="327.5" y1="1045.5781" y2="1045.5781"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="58.5" y="1040.5122">SAML Logout Response</text><polygon fill="#181818" points="62.5,1053.5781,52.5,1057.5781,62.5,1061.5781,58.5,1057.5781" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="332.5" y1="1057.5781" y2="1057.5781"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="133" x="193.5" y="1070.645">Logout warning page</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="545" y1="1083.7109" y2="1083.7109"></line><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="116" x="15" y="1093.9214">[logout sucessful]</text><polygon fill="#181818" points="62.5,1097.5156,52.5,1101.5156,62.5,1105.5156,58.5,1101.5156" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="474" y1="1101.5156" y2="1101.5156"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="281" x="187" y="1114.5825">SAML Logout Response with "Success" code</text><polygon fill="#181818" points="321.5,1143.7813,331.5,1147.7813,321.5,1151.7813,325.5,1147.7813" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;" x1="51.5" x2="327.5" y1="1147.7813" y2="1147.7813"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="150" x="58.5" y="1142.7153">SAML Logout Response</text><polygon fill="#181818" points="62.5,1155.7813,52.5,1159.7813,62.5,1163.7813,58.5,1159.7813" style="stroke:#181818;stroke-width:1.0;"></polygon><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56.5" x2="332.5" y1="1159.7813" y2="1159.7813"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="144" x="182.5" y="1172.8481">Logout complete page</text></g></svg>

<p>The scenario begins when a user clicks a logout button on the relying party site
they have been using. When this happens:</p>

<ol>
  <li>The relying party application logs the user out locally first, then it
redirects the browser to the legacy CSP’s SAML Single Logout endpoint with a
SAML <code class="language-plaintext highlighter-rouge">LogoutRequest</code> message.</li>
  <li>If the user has visited additional sites that are still connected directly to
the CSP (instead of to Sign In Canada) it will first propagate the logout to
all of those sites using SAML back-channel (SOAP) logout. This is done one at
a time, while the user waits, after which the user is now <strong>completely logged
out of the GCCF</strong>.</li>
  <li>To log the user out of Sign In Canada, the GCCF CSP then redirects the
browser to Sign In Canada’s Acceptance Framework with a SAML <code class="language-plaintext highlighter-rouge">LogoutRequest</code>
message.</li>
  <li>The Acceptance framework then creates an OpenID Connect logout request and
redirects the browser to the Acceptance Platform’s OpenID Provider (OP)’s
end_session endpoint.</li>
  <li>If any relying parties participating in the Acceptance Platform’s session
support back-channel logout, the Acceptance Platform sends a logout token to
all of them first, via an HTTP POST to their registered back-channel logout
URI(s). This triggers the logout actions by each of those RPs. If there are
multiple relying parties then these requests are all sent simultaneously, in
parallel.</li>
  <li>Once back-channel logout has been completed, the Acceptance Platform returns
an <a href="https://html.spec.whatwg.org/multipage/">HTML</a> logout
propagation page. This page contains a number of
<a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a>
elements. The <code class="language-plaintext highlighter-rouge">src</code> (source) attribute of each <em>iframe</em> element points to the
front-channel logout
<a href="https://openid.net/specs/openid-connect-frontchannel-1_0.html#RPLogout">URI</a>
of one of the relying party sites where the user has logged in during their
current session. In the diagram, these other sites are identified as “Other
SIC RPs”. The <code class="language-plaintext highlighter-rouge">src</code> attribute of the final <em>iframe</em> points to a URI endpoint
of the Acceptance Platform’s Acceptance Framework.</li>
  <li>Upon receiving the propagation page, the browser begins to load all of the of
the <em>iframe_s in parallel, by asynchronously sending an HTTP GET request to
the <code class="language-plaintext highlighter-rouge">src</code> URI of each _iframe</em>.</li>
  <li>As the other relying parties receive these requests, they log the user out
locally, and then return an HTTP response to the browser.</li>
  <li>The logout propagation page has a global <code class="language-plaintext highlighter-rouge">onerror</code> event handler that will be
triggered if any kind of error occurs while all of the _iframe_s are
propagating the logout to various sites asynchronously.</li>
  <li>If any of the <code class="language-plaintext highlighter-rouge">iframes</code> fail or time-out, the <code class="language-plaintext highlighter-rouge">onerror</code>event handler will
   redirect the browser to the Acceptance Framework with an HTTP request that
   indicates a logout problem.
    <ol>
      <li>The Acceptance Framework will then redirect the browser back
to the CSP with a SAML <code class="language-plaintext highlighter-rouge">LogoutResponse</code> message bearing a status code of
<code class="language-plaintext highlighter-rouge">urn:oasis:names:tc:SAML:2.0:status:Responder</code>.</li>
      <li>The CSP will then in turn redirect the browser back to it’s own RP with a
  <code class="language-plaintext highlighter-rouge">LogoutResponse</code> message bearing a top level status code of
  <code class="language-plaintext highlighter-rouge">urn:oasis:names:tc:SAML:2.0:status:Success</code> and a second-level status
  code of <code class="language-plaintext highlighter-rouge">urn:oasis:names:tc:SAML:2.0:status:PartialLogout</code>.</li>
      <li>This will cause the SAML RP to display error page, warning the user that
they may not be completely signed out and recommending that they close
their browser.</li>
    </ol>
  </li>
  <li>If all of the <code class="language-plaintext highlighter-rouge">iframes</code> successfully propagate logout to their target site,
the JavaScript code will redirect the browser to the Acceptance Framework
with an HTTP request that indicates a successful logout.
    <ol>
      <li>The Acceptance Framework will then redirect the browser back to the CSP
with a SAML <code class="language-plaintext highlighter-rouge">LogoutResponse</code> message bearing a status code of
<code class="language-plaintext highlighter-rouge">urn:oasis:names:tc:SAML:2.0:status:Success</code>.</li>
      <li>The CSP will then in turn redirect the browser back to it’s own RP with a
<code class="language-plaintext highlighter-rouge">LogoutResponse</code> message bearing a top level status code of
<code class="language-plaintext highlighter-rouge">urn:oasis:names:tc:SAML:2.0:status:Success</code> and no  second-level status
code.</li>
      <li>This will cause the SAML RP to display their usual logout or landing page.</li>
    </ol>
  </li>
</ol>

</main>


<footer role="contentinfo" id="wb-info">
  <nav role="navigation" class="container wb-navcurr">
    <h2 class="wb-inv">About government</h2>
    <ul class="list-unstyled colcount-sm-2 colcount-md-3">
      <li><a href="mailto:SignIn-AuthentiCanada@tbs-sct.gc.ca">Contact us</a></li>
      <li><a href="https://www.canada.ca/en/government/dept.html">Departments and agencies</a></li>
      <li><a href="https://www.canada.ca/en/government/publicservice.html">Public service and military</a></li>
      <li><a href="https://www.canada.ca/en/news.html">News</a></li>
      <li><a href="https://www.canada.ca/en/government/system/laws.html">Treaties, laws and regulations</a></li>
      <li><a href="https://www.canada.ca/en/transparency/reporting.html">Government-wide reporting</a></li>
      <li><a href="http://pm.gc.ca/eng">Prime Minister</a></li>
      <li><a href="https://www.canada.ca/en/government/system.html">How government works</a></li>
      <li><a href="http://open.canada.ca/en/">Open government</a></li>
    </ul>
  </nav>
  <div class="brand">
    <div class="container">
      <div class="row">
        <nav class="col-md-9 col-lg-10 ftr-urlt-lnk">
          <h2 class="wb-inv">About this site</h2>
          <ul>
            <li><a href="https://www.canada.ca/en/social.html">Social media</a></li>
            <li><a href="https://www.canada.ca/en/mobile.html">Mobile applications</a></li>
            <li><a href="https://www1.canada.ca/en/newsite.html">About Canada.ca</a></li>
            <li><a href="https://www.canada.ca/en/transparency/terms.html">Terms and conditions</a></li>
            <li><a href="https://www.canada.ca/en/transparency/privacy.html">Privacy</a></li>
          </ul>
        </nav>
        <div class="col-xs-6 visible-sm visible-xs tofpg">
          <a href="#wb-cont">Top of Page <span class="glyphicon glyphicon-chevron-up"></span></a>
        </div>
        <div class="col-xs-6 col-md-3 col-lg-2 text-right">
          <object type="image/svg+xml" tabindex="-1" role="img" data="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/assets/wmms-blk.svg" aria-label="Symbol of the Government of Canada"></object>
        </div>
      </div>
    </div>
  </div>
</footer>


<!--[if gte IE 9 | !IE ]><!-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
<script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/js/wet-boew.min.js"></script>
<!--<![endif]-->
<!--[if lt IE 9]>
<script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/js/ie8-wet-boew2.min.js"></script>
<![endif]-->
<script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_31/js/theme.min.js"></script>

</body>

</html>
